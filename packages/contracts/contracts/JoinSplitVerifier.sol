// SPDX-License-Identifier: MIT OR Apache-2.0
pragma solidity ^0.8.17;

import {Pairing} from "./libs/Pairing.sol";
import {Groth16} from "./libs/Groth16.sol";
import {IJoinSplitVerifier} from "./interfaces/IJoinSplitVerifier.sol";

contract JoinSplitVerifier is IJoinSplitVerifier {
    function verifyingKey()
        internal
        pure
        returns (Groth16.VerifyingKey memory vk)
    {
        vk.alpha1 = Pairing.G1Point(
            20491192805390485299153009773594534940189261866228447918068658471970481763042,
            9383485363053290200918347156157836566562967994039712273449902621266178545958
        );

        vk.beta2 = Pairing.G2Point(
            [
                4252822878758300859123897981450591353533073413197771768651442665752259397132,
                6375614351688725206403948262868962793625744043794305715222011528459656738731
            ],
            [
                21847035105528745403288232691147584728191162732299865338377159692350059136679,
                10505242626370262277552901082094356697409835680220590971873171140371331206856
            ]
        );
        vk.gamma2 = Pairing.G2Point(
            [
                11559732032986387107991004021392285783925812861821192530917403151452391805634,
                10857046999023057135944570762232829481370756359578518086990519993285655852781
            ],
            [
                4082367875863433681332203403145435568316851327593401208105741076214120093531,
                8495653923123431417604973247489272438418190587263600148770280649306958101930
            ]
        );
        vk.delta2 = Pairing.G2Point(
            [
                6951432554751821470666639479383739129656562698093131907479585452174608591421,
                1338903763788632844290055225614662007038180770926322994380170981031330523530
            ],
            [
                13477308226368552393616026547226275762995364857742000414576624863552234658081,
                12788946999155520184501322357182900815864797397405033445077644939627141276729
            ]
        );
        vk.IC = new Pairing.G1Point[](14);

        vk.IC[0] = Pairing.G1Point(
            9524985516120418107975902189443349338859670708689358711231918784968189969937,
            20126430599005730873466796188517981279028686335762847957312250891091598557443
        );
        vk.IC[1] = Pairing.G1Point(
            7076484465209111843099314392290347318728611219335521304546320777721633431171,
            3477177891781106823283705544517850007690194911112166112930082139365335269455
        );
        vk.IC[2] = Pairing.G1Point(
            16903069826561552461797467783499608405329126392469352955863254497424037692310,
            12246400550262150248059154032032413063400605178501358821847643632100344732643
        );
        vk.IC[3] = Pairing.G1Point(
            14886788532249239447581019631337070956826278094833948640302181658577591786658,
            18890694838550696611836851221993324099785568777373674413373388591471911509816
        );
        vk.IC[4] = Pairing.G1Point(
            3901744820901125560573571756449831714821611757303955640045430725369400734147,
            2937501672321940430830690554918714297028761016391639278802768221502205063448
        );
        vk.IC[5] = Pairing.G1Point(
            11352033973079023306212632693545810795733039101531697532740960076687876646862,
            19840295880375087362536859073797660900514915911440638898368289513181295060623
        );
        vk.IC[6] = Pairing.G1Point(
            3656682403215717280010584102825631050387380561464117450215335130297677114284,
            18502070453480691357583372156048407349366744484001371788701061952122645482785
        );
        vk.IC[7] = Pairing.G1Point(
            6754228255921444687291588687398589198620011822787398508430490485897004089334,
            17158770299305770601261003892903199011470808699493330483925141919468987536374
        );
        vk.IC[8] = Pairing.G1Point(
            7908219712746056347109091017629871181480438600545767573033601406420591564879,
            11036266516723453324829043639866188012689922133398952512544792760550228974755
        );
        vk.IC[9] = Pairing.G1Point(
            1276097426795285996094571176892764604470257606620213581226901201299043250808,
            2468074186331884131605654154544448442411809993567250721909334320557835837783
        );
        vk.IC[10] = Pairing.G1Point(
            3031491274140332569773804626661476094347840955701243555916341202192685063367,
            11163865120055582121596291554167536186197708266050364165200907153426222729847
        );
        vk.IC[11] = Pairing.G1Point(
            19502689083364820358995261968205870251381602275411023295691885030762848184014,
            12352510520382165789326005220689136572925454792752290992005274966175493869626
        );
        vk.IC[12] = Pairing.G1Point(
            11514194557156426792859022527116403913104113770126404110633942660234578280462,
            19131881803394072020211640431890947338192925627218990720275998123142672930248
        );
        vk.IC[13] = Pairing.G1Point(
            4210122220855990149596420290088849445745841945220858056349180312795557205598,
            21195277088876147341647593240843289054061973080002976265125842821202426949704
        );
    }

    /// @return r  bool true if proof is valid
    function verifyProof(
        uint256[8] memory proof,
        uint256[] memory pi
    ) public view override returns (bool r) {
        return Groth16.verifyProof(verifyingKey(), proof, pi);
    }

    /// @return r bool true if proofs are valid
    function batchVerifyProofs(
        uint256[8][] memory proofs,
        uint256[][] memory allPis
    ) public view override returns (bool) {
        return Groth16.batchVerifyProofs(verifyingKey(), proofs, allPis);
    }
}
